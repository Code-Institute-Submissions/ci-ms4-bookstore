{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<div class="row">
  <div class="container-fluid">
    <h1 class="text-center">{{ product.title }}</h1>
  </div>
</div>
<br>
{% if request.user.is_superuser %}
<hr>
<div class="row">
  <div class="container-fluid">
      <!-- TO DO: Add handlers for editing and deleting -->
    <h3 class="text-center">Administrative tools for product: {{ product.title }} (<a href='#'><i class="fas fa-edit"></i></a>  <a href="#"><i class="fas fa-trash-alt"></i></a>)</h3>
  </div>    
</div>
<hr>          
{% endif %}
<div class="row">
  <div class="container-fluid">
    <table>
      <thead>
        <th>Upvotes:</th>
        <th>Downvotes:</th>
      </thead>
      <tbody>
        <tr>
          <td>{{product.upvote}}</td>
          <td>{{product.downvote}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
<br>
<div class="row">
  <div class="container-fluid">    
    <div class="col-sm-12 col-md-4">
      <img class="img-responsive" src="{{product.cover.url}}">      
    </div>
    <div class="col-sm-12 col-md-8">
      <p>{{product.description}}</p>
    </div>
    <form class="form" method="POST" action="{% url 'add_to_bag' product_id=product.id %}">
      {% csrf_token %}
      <label for="quantity">Quantity: </label>
      <input type="number" value="1" class="form-control" name="quantity" min="1">
      <input type="hidden" name="redirect_url"  value="{{ request.path }}">
      <button class="btn btn-primary" type="submit">Add to bag!</button>
    </form>
  </div>
</div>

<form method="POST">
  <div class="form-group">
    {% csrf_token %}      
    {{ form|crispy }}
  {% if request.user.is_anonymous %}
  <h5><a href="{% url 'account_login' %}">Only logged in users can add reviews! Click here to log in!</a></h5>
  {% else %}
  <h5>By: {{request.user}}</h5>
  <button type="submit" class="btn btn-primary">Add review</button>
  {% endif %}
  </div>
</form>

{% endblock %}